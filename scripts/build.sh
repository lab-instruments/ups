# ------------------------------------------------------------------------------
#  Name   :  Top Level UPS Build Script
#  Author :  Mike DeLong
# ------------------------------------------------------------------------------

# ------------------------------------------------------------------------------
#  Setup Script
# ------------------------------------------------------------------------------
source ./utils.sh
source ./setup.sh

# ------------------------------------------------------------------------------
#  Setup Build Paths
# ------------------------------------------------------------------------------
BD=`realpath ../build`
SD=`realpath ../build/sdk`
LD=`realpath ../build/log`
DD=`realpath ../deploy`
CD=`realpath ../yocto`

# ------------------------------------------------------------------------------
#  Setup Build Directories
# ------------------------------------------------------------------------------
# Create Build Dir
if [ ! -d ${BD} ]; then
    mkdir ${BD}
fi

# Clear Deploy Dir
if [ ! -d ${DD} ]; then
    mkdir ${DD}
else
    rm -rf ${DD}
    mkdir ${DD}
fi

# Clear SDK Dir
if [ ! -d ${SD} ]; then
    mkdir ${SD}
else
    rm -rf ${SD}
    mkdir ${SD}
fi

# Clear Log Dir
if [ ! -d ${LD} ]; then
    mkdir ${LD}
else
    rm -rf ${LD}
    mkdir ${LD}
fi

# ------------------------------------------------------------------------------
#  Setup Paths
# ------------------------------------------------------------------------------

# ------------------------------------------------------------------------------
#  Build U-Boot
# ------------------------------------------------------------------------------
# ./build-uboot.sh --build_dir=${BD} --log_dir=${LD} --deploy_dir=${DD} --board="coraz7"

# ------------------------------------------------------------------------------
#  Build FPGA Hardware
# ------------------------------------------------------------------------------
# ./build-fpga-hw.sh --build_dir=${BD} --log_dir=${LD} --deploy_dir=${DD} --sdk_dir=${SD} --board="coraz7"

# ------------------------------------------------------------------------------
#  Build FPGA SDK
# ------------------------------------------------------------------------------
# ./build-fpga-sdk.sh --sdk_dir=${SD} --log_dir=${LD} --deploy_dir=${DD}

# ------------------------------------------------------------------------------
#  Build FPGA SDK
# ------------------------------------------------------------------------------
# ./build-yocto.sh --build_dir=${BD} --conf_dir=${CD}
./build-br.sh --build_dir=${BD} --conf_dir=${CD}
